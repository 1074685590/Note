**Email Note**

### 2022-08-04

1. 领京豆挽留弹窗RN+H5需求已提测，测试下个礼拜一才能支持；
2. 领京豆H5导航栏适配计划跟随这个版本就行测试，后续直接走通天塔发布，iOS内置包暂不集成此需求；



- 1、领京豆首页通过自定义异常监控信息发现通过CDN下发lottie文件的耗时过长且失败率过高，通过设置lottie文件的超时时间和lottie动画的兜底动画解决了首开时间过长的问题。
- 2、领现金架构升级，采用Kotlin代码进行编写，采用MVVM架构；
- 3、领京豆架构升级、代码优化、性能优化分享（丰碑）；
- 4、专利：一种基于lottie动画的动态化互动方案、
- 5、Lottie动画精细化降级（lottie+原生动画）、动态化配置（互动行为通过js动态下发）
- 6、领现金瘦身：本地图片转下载、架构升级、
- 7、领京豆版本治理：多版本共存存在的问题（维护成本、体验不一致、复杂的降级方案）-》单版本体验优化、动画效果最大程度还原、组件化、配置化、瘦身经验赋能领现金、
- 8、Android领京豆接口预加载、
- 9、领现金接口预加载、
- 10、架构图、
- 11、根据领京豆的实际开发，总结并提炼出一些专业系统的工作流程、或是经验分享，为其他互动项目提供借鉴。





领京豆今日进展：

1、领京豆今天将Lottie库迁移的代码集成到Android和iOS的10.1.5灰度分支，计划10.1.6版本合入主分支；

2、领京豆3.5页面目前切量30%，暂无异常；

3、领现金今天将target30适配代码集成到10.1.5灰度分支；

4、领京豆需求评审延期到明天，今天把领现金提现兑换页面框架基本搭建起来，采用纯Kotlin进行开发，后续计划将兑换记录页面的列表交给刘延练手。





领京豆周报：

1、 本周领京豆3.5版本目前切量40%，暂无异常;

2、本周领现金将target30适配代码集成到10.1.5灰度分支；

3、本周领京豆将Lottie库迁移的代码集成到Android和iOS的10.1.5灰度分支，计划10.1.6版本合入主分支‘

4、本周领现金两个页面的框架已经搭建完毕，兑换页面的两个楼层UI部分已经绘制完毕，提现记录页面交由刘延进行开发，目前总体进度20%；

5、本周领京豆10.1.6跟版需求UI部分经绘制完毕，接口尚未ready，计划本周五进行提测；





领京豆周报：

1、 本周领京豆3.5版本目前切量60%，暂无异常;

2、本周领京豆10.16 签到弹窗、通用banner、埋点等需求跟测及代码集成；

3、本周领京豆双十一全民抢京豆活动页进入开发，涉及到抢京豆活动页面的UI改造、新增一个助力半屏弹窗，新增短口令和小程序卡片分享能力，计划中秋节前完成开发，目前预估无风险；

4、本周领现金提现与兑换页面UI部分已经绘制完成，优惠券兑换弹窗和红包兑换弹窗部分交由刘延进行开发，目前总体进度40%；





领京豆：

1、本周领京豆3.5版本首页全量，线上无异常；

2、本周领京豆全民抢京豆活动页已经完成开发和联调，由于测试20号才能进入，目前前端正在针对产品走查的问题进行修改并做一些代码的优化工作；

3、领现金目前已经完成了页面的开发工作，目前进入联调阶段。领现金提现兑换中心页面代码采用Kotlin进行编写，采用MVVM的架构方式进行搭建，兑换记录页面由刘延负责编写，后续由刘延进行新代码熟悉和自测工作；

4、H5 uuid脱敏改造涉及到领京豆首页2.0和3.0版本的两个页面，本周完成了uuid脱敏改造任务，目前uuid脱敏改造后的领京豆2.0和3.0 首页H5已经上线；





领京豆：

1、本周完成了对全民抢京豆活动页的走查问题的修复，测试22号介入，预计26号完成测试；

2、本周通过用户之声发现领京豆H5首页的升级弹窗的按钮图片出现了适配问题（不涉及RN首页），目前已经完成了修改，计划下周测试完成后上线；

3、本周领京豆购物返需求因京豆中台本周跟进大促，故BRD联评时间调至下周；

4、本周通过内存检测工具发现领现金有几处内存泄漏，目前已经对新增代码部分完成了修复，老代码部分涉及到线上逻辑的修改有一定风险，暂定后续版本研发时间充裕时再优化；





领京豆：

1、本周全民抢京豆活动页进行了预发全流程走查，计划29号下午上线，主要活动入口为领京豆首页通栏banner和签到后弹窗；

2、本周参与了领京豆购物返BRD与PRD联评，目前与上游的部分依赖尚未解除；前端计划采用RN转H5的方式进行开发，UI计划11月12号输出部分视觉稿；

3、领京豆计划10.2.4版本进行lottie库的线上迁移工作，前期已经进行过小版本灰度，未发现异常；

4、本周领现金进行了测试用例评审，根据评审的内容Android有几处需要修改的UI和逻辑，交由刘延、吴梓轩跟进。









领京豆：

1、本周iOS swift版本Lottie库从主站内移除，JDReact相关的Lottie组件也已经移除，领京豆使用的Lottie库也从swift版本的替换为了OC版，目前迁移工作已经完成，跟版10.2.4；

2、本周领京豆购物返需求视觉部分没有按期给到，内部需求评审延期，前端计划采用H5完成购物返需求，目前正在熟悉陈闻高的H5框架；

3、刘延、吴梓轩本周继续安卓领现金业务跟测以及增加埋点上报，目前暂无bug；

\2. 根据上周测试用例评审内容，调整优惠券弹窗兜底方案及兑换记录底部文案；

\3. 安卓包体积大小优化（移除“关注好物”模块）；

\4. “购物返豆”React项目熟悉（界面初始搭建练习）；







购物返页面

https://…… .html?source=渠道&orderStatus=0

……:页面尚未发布，H5链接暂无法提供

source:渠道参数，领京豆运营提供

orderStatus:订单状态（0、可领取、1：已到账、2：生成中、3、已失效） ，不传此参数默认为可领取状态



领京豆首页H5

https://h5.m.jd.com/rn/3MQXMdRUTeat9xqBSZDSCCAE9Eqz/index.html?has_native=0&source=渠道&orderStatus=0

领京豆首页RN

[openapp.jdmobile://virtual?params=](https://cf.jd.com/openapp.jdmobile:/virtual?params=){"category":"jump","des":"jdreactcommon","modulename":"JDReactJDBeansGame","appname":"JDReactJDBeansGame","param":{"page":"JDReactJDBeansGame","source”:”渠道”,”transparentenable":true,”orderStatus”:0}}





领京豆：

1、本周领京豆Lottie库迁移需求代码集成到10.2.4版本；

2、为目前响应集团IOS提审合规性要求领京豆计划10.2.6版本接入集团的精细化屏蔽，IOS提审版本（version+build） 2.0/3.0/3.5页面提审期间展示一张静态兜底图片，长期方案为采用H5离线包的方式规避iOS审核；

3、领现金本周完成兑换中心页面和兑换记录页面需求的跟测，代码已经集成到10.2.4版本，由于后端尚未上线，目前线上配置屏蔽新页面的入口，待后端 15 日上线后进行验证（吴梓轩、刘延）；





领京豆：

1、为了响应集团IOS提审合规性要求，本周领京豆在2.0、3.0 H5首页 进行版本屏蔽功能需求的开发，根据后端下发的屏蔽字段进行画报展示，为了应对线上合规的紧急情况，又做了一套根据运营配置来展示画报的功能，目前已经开发完成，计划本周五提测；

2、本周领京豆购物返需求和上游沟通多轮，计划本周五进行内部需求评审，共涉及到3个H5页面的开发，前端本周完成了部分H5页面框架的搭建；（王顺、吴梓轩）





领京豆：

1、领京豆在2.0、3.0 首页进行iOS精细化屏蔽功能需求RN部分已经集成代码到10.2.6版本，H5部分已经上线，暂无异常；

2、领京豆购物返需求本周开始进入开发阶段：领京豆首页新增购物返icon入口和倒计时引导蒙、原购物返楼层标题和购物返列表RN页面标题修改、领京豆3.0 H5页面接入离线包，此部分需求跟版10.3.0；购物返页面本周进入框架搭建，计划本周内完成框架的搭建和楼层框架划分工作；





领京豆：

1、购物返需求领京豆首页跟版部分前端已经完成，后端接口尚未支持联调，计划本周五完成提测；

2、购物返主页面框架和部分楼层UI部分已经完成，Feeds流和Push引导弹窗目前已经接入，目前总体进度35%；

3、领京豆首页H5接入WebView离线包目前由于包内图片引用不到，Hybrid侧正在修改，计划本周内完成离线包接入；

4、领现金本周新增跳转离开页面后返回刷新页面的逻辑，计划本周内完成并提测，10.3.0上线；





领京豆：

1、领京豆购物返跟版需求、H5离线包已经集成至10.3.0版本；

2、购物返页面京豆球楼层接口对接及兜底展示、订单列表楼层完成接口对接和兜底逻辑本周已经基本完成，由于后端接口文档还在调整，后续接口对接仍会有小幅度调整；

3、目前购物返页面UI部分除了部分兜底图尚未提供外大部分都已经绘制完成，预计本周内完成所有的UI部分绘制；

4、领现金“金融双签”、优惠券卡片toast提示等需求本周跟版10.3.0；



领京豆：

1、领京豆购物返页面本周完成了埋点开发、文案字段的兜底、feeds兜底样式，本周已经完成了前后端的联调，计划本周五提测；

2、领现金兑换红包出现兑换金额和用户总金额相等时兑换提示金额不足的bug，经过和运营沟通，定下方案为10.3.0在灰度期间修复，10.2.4和10.2.6版本通过客服引导提示用户做任务和签到可以使得用户总金额大于兑换金额避免此问题，目前10.3.0版本已经应用市场发布，通过引导用户升级app也可以解决客诉问题，经过评估风险暂时可控。









互动频道大多涉及到虚拟资金的交易往往会受到各方（苹果审核、微信封禁）的制约，由于长期缺乏统一明确的、规范化的管理，每次审核被拒或者微信封禁都要各个业务紧急进行整改，大大限制互动的研发效能和浪费了研发资源。

方案：构建统一的互动容器，各个互动项目进行统一组件化管理，构建全局一致的降级方案，减少开发成本和应对紧急情况的能力。





互动频道在开发阶段难以对虚拟资金进行全链路自测，涉及到红包、优惠券、京豆等虚拟资产时需要运营找别的团队进行申请后才能自测，申请的自测数据难以支持多频次自测需求，而前端自己mock的数据又往往不能对前置链路的相关场景进行全面覆盖，这对前端的研发效能造成较大影响。

方案：构建红包、优惠券、京豆等虚拟资产的预发\线上环境的mock平台或者账号，可以使相关虚拟资产数据完成全链路自测的能力。





互动频道缺乏统一的组件能力，例如计时器、进度条、滑动列表组件等，每个互动频道要实现相关能力必须自己写一套，或者每个小组内都有自己的组件库，有很多库具备的能力有很大的重复性，造成互动频道为了实现某些通用能力，往往要引入多个相似的库，增加了包大小。

方案：构建完备的组件库或者互动框架





领京豆：

1、领京豆购物返页面本周完成了和上游的联调工作，计划周五上线暂不投放入口，下周一进行上下游线上联调，联调通过后跟版部分集成代码到主分支；

2、领现金新增放开兑换中心入口浮动动画的需求，本周内已经完成了相关开发，计划本周五集成代码；







领京豆：

1、领京豆购物返页面本周进行了二期评审，新增过期订单tab列表、京东小报轮播楼层、优惠券楼层、通栏banner楼层等，目前进度35%；

2、由于X项目带来的降级因素购物返豆春节期间线上开放白名单验证且不对外投放，节后开始切量；领京豆首页春节前不再上新的需求，春晚期间的降级措施目前尚未最终敲定；

3、领现金Android部分本周已完成了首页兜底降级、兑换中心优惠券弹窗、兑换中心入口文案支持配置、H5内置包等需求的开发工作，元旦后提测；





周报：

领现金：首页降级、兑换入口文案动态化、优惠券弹窗等已集成至10.3.3及10.3.4





领京豆：

1、领京豆频道春晚降级方案已经确定，后端采取限流措施，被限流命中的用户展示网络异常页面，未命中的用户页面展示正常；备用降级方案为展示静态画报；目前前端已经完成了降级需求的开发，本周已经完成测试并合并代码到10.3.3、10.3.4主分支；

2、领京豆购物返需求由于新插入的春晚降级需求进度有所延后，目前购物返京豆页面二期需求总体进度45%；

3、领现金完成首页降级、兑换入口文案动态化、优惠券弹窗等需求，本周已集成至10.3.3、10.3.4主分支；





1、领现金：兑换京豆需求前后端联调，因缺少豆池数据，预计节后验证

2、领京豆本周完成了失效礼包弹窗的开发、支付页跳转承接弹窗的开发，目前受**X**项目影响后端接口尚未**ready**，购物返二期需求整体进度**60%**；





1、领现金：领现金代码重构优化实践，MVI架构使用实践；

2、领京豆本周完成了购物返二期需求的开发，目前受**X**项目影响后端接口尚未**ready**无法进入联调，根据之前的计划此需求年后**2**月**16**号提测，购物返二期需求整体进度**80%**；

**3**、领京豆首页接到埋点部门的反馈，领京豆首页底部**feeds**流部分点击跳转到商详后在回退到领京豆首页缺失回退埋点，领京豆之前未接到此类埋点需求，经过讨论埋点部门给领京豆提需，新增领京豆首页回退埋点需求，此需求计划年后跟版；



1、领现金：领现金代码重构优化实践，MVI架构使用实践；

2、领京豆本周完成了埋点部门反馈的回退埋点，计划年后跟版集成；

3、领京豆购物返二期需求，前端部分已经完成，本周进行了代码结构优化和字段添加保护等，计划年后和后端进行联调，整体进度85%；







领京豆：

1、领京豆首页新增购物返页面参数、浏览任务修复、回退埋点等需求代码集成、内置包集成已经完成；

2、购物返一期目前已经切量上线，切量计划如下图所示；

3、购物返二期新增已失效tab、支付页跳转承接弹窗、广播栏、一行两个banner、失效订单奖励弹窗、一键置顶等需求已提测，跟侧中；

4、购物返一期plus侧反馈界面对plus用户不够友好，经过协商需要对线上的一期页面进行改造，对plus用户屏蔽订单列表并对部分文案行间距进行调整，计划本周内开发完成并提测；

4、领现金：准备下周四(2.24)丰碑分享PPT，课题《安卓官方推荐架构MVI介绍及其场景应用》



领京豆：

1、领京豆购物返豆二期已经测试通过，原计划本周四上线，由于后端线上接口出现了问题，上线时间延后到本周五；

2、领京豆购物返豆一期本周四已切量到40%，预估单日影响用户数211W，目前线上无页面异常的反馈；

3、领京豆购物返豆一期本周收到plus侧的反馈，为了优化plus用户的页面显示，页面订单列表楼层需要对plus用户进行隐藏并优化顶部文案的显示，目前此紧急优化需求已经测试通过并发布上线；

4、烛龙监控平台提出领现金首屏耗时工单，10.4.0耗时环比增加45%。但10.4.0并无新增领现金代码。分析数据发现，2月7日10.4.0渠道发布当天首屏耗时大量增加，2月8日后回到正常值。初步判断是应用安装时，有一些预加载或者无缓存导致。目前此工单已经挂起，待继续观察一下10.4.2数据是否异常再制定下一步的计划。



领京豆：

1、本周完成购物返豆页面plus用户页面顶部视觉优化，包括页面顶部氛围图替换、按钮样式调整、icon替换、按钮小手动画等，计划本周五提测；

2、购物返豆页面截止当前已切量用户数1489w，截止3月2日妥投且需手动领京豆用户数374w，可领京豆数14516w，已领用户数15w，累计用户领取率4.1%，已领京豆数1252w，累计京豆领取率8.6%。目前线上暂无页面异常的反馈。

3、



领京豆：

1、本周完成领京豆首页H5关注组件的接入、pv埋点新增渠道参数的需求；

2、领京豆首页发现用户在0点前完成签到后，0点后再次点击签到按钮进入签到日历页会导致页面兜底异常页，经过和产研侧开会讨论，计划将领京豆首页每次进入签到日历页回退到领京豆首页时刷新首页接口，更新签到按钮状态，此项改造计划根本11.1.0；

3、本周处理了RN中台热更版本覆盖的问题，新发了两次热更，覆盖了10.5.4~11.0.2以及11.0.4版本，按照灰度三天的节奏，本周五晚上十一点全量；



3、本周调研了一下领京豆首页H5一键置顶功能在iOS15.4版本上会出现白页的问题，经过排查发现此问题出现在页面尚处在滑动状态下然后触发置顶时会导致页面白屏，计划通过用户点击置顶按钮时禁止页面滚动，等页面置顶后在允许页面滚动，经过测试此方法可行，计划后续充分自测后再让产品提需；



领京豆：

1、本周完成了领京豆首页H5烛龙埋点接入，H5已上线，内置包已集成；

2、本周领京豆首页H5新增关注组件、PV埋点新增渠道参数RN跟版11.1.0代码集成，H5已发布；

3、JMFE两篇文章初始版本已发布，后续继续修改完善（http://jmfe.jd.com/articles/278 ，http://jmfe.jd.com/articles/279）；

4、11.1.2版本需求评审，新增跨天签到问题优化，H5 lottie-web接入，一键置顶iOS兼容问题修复；



领京豆：

1、领京豆跨天签到逻辑优化、首页feeds流商品京东价格兜底逻辑优化、H5兼容Lottie动画、一键置顶兼容问题优化 需求已经提测；

2、可领豆接口逻辑优化需求依赖后端接口字段，待后端提供字段后再进度开发；

3、H5兼容Lottie动画需求需要后端新增灰度开关，待后端提供开关字段后再加入开关逻辑；

4、以上需求跟版11.1.2（prd: https://cf.jd.com/display/ljd/V11.1.2）；





领京豆：

1、领京豆H5 lottie动画灰度目前放量60%，计划7月7日 80%，7月8日 100%。该灰度采用的是后端已发布机器的量的占比，没有采用动画切量开关字段，目前线上无异常反馈；

2、领京豆11.1.4版本需求评审（PRD：https://cf.jd.com/display/ljd/V11.1.4），涉及到前端的需求有领京豆首页退出弹窗优化，**2.0**版本领京豆页面下线和重定向改造（部分投放渠道已不可查，这部分渠道通过改造**2.0**页面使其重定向到**3.0**版本**H5**页面），计划本周进入开发，跟版**11.2.0**版本（**7.26**集成代码）；

**3**、满天星**LBS**楼层目前**UI**和接口部分已经完成，广告组接口已经跑通；目前部分接口字段缺失，尚不能完整自测，计划本周内继续完善兜底逻辑；



领京豆：

1、领京豆农场引流任务本周已提测，跟测中；计划RN采用热更方式上线，H5直接发布，iOS的H5内置包跟版11.2.0；

2、领京豆2.0版本H5页面计划改造为静态图页面然后重定向到3.0 领京豆H5页面，此需求是为了解决2.0版本未知投放坑位的兜底，待H5重定向需求上线后，2.0版本的RN计划采用ARES降级方式直接兜底到3.0版本的H5页面，计划本周完成并提测；

3、满天星LBS楼层已提测，跟测中；



Lbs楼层测试新增测试用例：

1、广告组接口请求超时、lbs信息获取失败、低于9.0.0版本、店铺列表为空 展示兜底样式；

7.21领京豆农场引流任务集成到11.2.0版本；