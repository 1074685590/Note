# 周报

## 2020-07-16

1. 领京豆首页大改版

   - 本周进行了领京豆大改版的需求初评，页面将采用RN技术框架进行开发，并进行RN转H5的适配；

   * 前端建议简化风控验证逻辑，采用手势验证方案，业务方考虑到签到完成页也需要同步改造风控验证逻辑的工作量和潜在的客诉风险，计划沿用之前的手势验证和拼图验证两种风控验证的方式，待上线后页面运行稳定后再着手改造简化风控逻辑；
   * 设计稿中页面底部feed流采用item高度不同瀑布流的方式进行展示，前端经过前期调研，这种布局方式在RN技术框架上实现有性能问题，经过讨论产品接受改为页面底部商品feed流采用等高的item进行展示；
   * 页面中部分楼层计划采用A/B test两种样式进行线上验证，前端需要对部分楼层进行两种样式的开发；

2. 领京豆首页H5和签到完成页H5投放m站适配

   * 领京豆首页H5和签到完成页H5在站外部分参数从ua中获取不到，经过后端对接口参数的梳理，前端针对部分参数值的获取方式进行了改造，部分参数将通过霍总小组维护的`jd-jskit`组件进行获取，目前该需求已经提测；

   * 领京豆首页H5为了减少百宝箱楼层中领京豆相关页面的适配工作量，领京豆首页H5将百宝箱楼层进行了屏蔽，在m中不展示百宝箱楼层和底部的feeds流的展示；

3. JDReact预加载功能影响了RN的拆包脚本，本周对领京豆模块的预置包重新打了拆分包到907灰度分支，目前已提交给测试进行验证；

4. 领京豆频道 ios 14系统beta2 上的“更多好店”、“购物返京豆”、“进店领豆”模块顶部状态栏展示异常，目前已经适配完成并提测；



## 2020-07-23

1. 领京豆首页大改版

- 本周进行了领京豆首页大改版的正式需求评审，由于领京豆视觉团队换成了上海的团队，目前还在交接期，视觉稿和UI切图预计要延期到下个礼拜才能给出一部分，而且由于交互细节上游还有未明确的地方，不排除新的视觉团队更改原有视觉稿的可能。

- 目前大改版的PRD中尚有很多不明确的地方，评审过程中前后端梳理了需要产品排除的依赖项、切量方案等细节。前端将识别出的风险同步了一下，具体内容包括：

  > - UI切图延期交付导致前端无法及时进入开发
  > - 浏览跳转页商品得京豆任务需要前端记录用户的浏览信息，存在用户清理手机数据导致浏览任务失败的场景
  > - 所有坑位的跳转链接均由后端下发，前端不做写死的跳转逻辑
  > - 业务想要迁移老版本的弹窗到新的版本上，由于老版本的弹窗种类繁多，前端建议前期先迁移部分重要的弹窗，后续版本迭代中在逐步迁移
  > - 关于广告商品的埋点问题，前端再次强调了一下埋点在H5上可能存在上报数据丢失的可能，建议产品侧涉及到广告商品埋点的需求要慎重
  > - 新页面底部feeds流商品涉及到分页的功能，后端考虑到工期问题，建议前期不做分页功能，前端这边需要在列表展示的逻辑中考虑到后续的分页功能，避免后续做分页功能时有大的改动
  > - 老版本中种豆得豆的跳转链接的下发依赖于领京豆的的部分参数，此次改版中前端建议排除此类依赖项

2. 本周领京豆大改版新模块的RN工程已经申请，目前已经完成了部分框架的搭建；
3. 领京豆首页H5和签到完成页H5投放m站适配，上周已提测，目前跟测中；
4. 领京豆频道 ios 14系统beta2 上的“更多好店”、“购物返京豆”、“进店领豆”模块顶部状态栏展示异常，上周已提测，目前跟测中；



## 2020-07-30

1. 领京豆大改版
   - 本周进行了领京豆首页大改版的评审，评审中主要同步了后端的部分确认的内容，前端由于视觉无输出，暂无进展。
   
   - 领京豆的视觉团队已经交接给了上海的团队，新的视觉团队向lottie汇报后，视觉稿的部分内容需要修改，计划修改顶部的签到区域为场景化的内容展示，类似种豆得豆的页面区域的展示方式。计划修改种豆得豆的入口为一个楼层的展示，且计划以场景化的楼层进行展示，主要是是想打通领京豆和种豆得豆，将种豆得豆将近百万的UV引流到领京豆页面中。（后续种豆得豆页面可能在页面中加入签到领京豆和营养液的功能）。
   
   - 本周已经完成了领京豆部分的保留逻辑迁移到新申请的RN工程中，其中包括风控逻辑、登录逻辑、Redux接入。RN转H5的页面已经在通天塔上成功部署。
   
   - 领京豆频道 ios 14系统beta2 上的“更多好店”、“购物返京豆”、“进店领豆”模块顶部状态栏展示异常的需求本周已经测试通过，计划跟版 9.1.0。
   
   - 领京豆首页H5和签到完成页H5投放m站适配已完成测试，计划本周上线。
   
     

## 2020-08-06

1. 领京豆大改版
   - 本周视觉给出了新页面feeds流三种样式的视觉稿，本周开始进行页面的feeds部分的UI开发，由于页面的其它部分尚未敲定，待选方案较多，前端需要等到终稿确定后再进行其它部分的开发工作；
   - 新页面后端之前的方案是准备使用一个接口来完成整个页面的接口请求，前端前期的网络框架搭建的时候也是按照这种网络请求的方式搭建的。由于feeds部分后台需要穿插素材，接口耗时较长，经过讨论后台将新页面接口拆分两个，底部的feeds流部分单独拆分为一个接口，本周前端根据新的接口方案改造了之前搭建的网络框架；

2. XView接口ViewKit、RN
   - 本周初步实现了XView接入ViewKit的Demo，Demo简单实现了Mock接口请求数据并将VK的视图展示出来，新增了按钮的关闭事件、实现了每天弹出次数的限制的逻辑、挽留弹窗的监听手机的返回事件等基本操作。后续计划基于通天塔任务组件实现XView接入的VK的弹窗组件。
   - 本周初步实现了Android接入RN的弹窗Demo，新增按钮的关闭事件。由于Native弹窗容器中需要动态加载RN弹窗内容的jsBundle，RN内容视图加载耗时较长。后续计划基于JDReact在站内尝试动态加载jsbundle，实现XView内嵌RN的弹窗。

## 2020-08-13

1. 领京豆大改版

   - 本周视觉给出了新页面的交互稿，交互稿整体上仍然采用楼层列表的展示方式，头部有浏览招商页面的任务进度，其他部分布局样式较为常规。视觉本周进入排期，下周可出部分UI切图标注。前端已反馈可以先出UI框架方便前端尽快进入页面的开发，具体切图和配色等可后续给出。

   - 本周在新页面工程中引入了iconfont，由于领京豆的页面h5和H5共用一套代码，H5部分不支持iconfont，所以计划只采用通用的iconfont，领京豆自有的icon计划采用图片转下载的方式引入icon图片减少包大小。

   - 本周前端完善了feeds流部分的样式细节，根据视觉给出的最新交互稿，样式上稍有区别，本周计划按照最新的视觉稿进行调整。

     综上：前端在领京豆大改版整体框架上已经比较完备，feeds部分的UI已经基本完成，总体进度10%；

     <img src="../img/领京豆大改版.png" alt="领京豆大改版" style="zoom:15%;" />

2. 本周初步完成了XView接入JDReact的弹窗Demo。后续计划进一步完善并和XView接入ViewKit的Demo进行合并重构，并输出一个完整的Demo示例。

## 2020-08-20

1. 领京豆大改版
   - 本周大改版大部分切图已给出[UI](http://relay.jd.com/web/project/0a11436d-08f5-4089-926e-7c61b5c10061#0|61c38cab-570e-4915-a043-7e603e9292f0)，本周完成了惊喜福利楼层的A、B两种楼层样式和逛店铺楼层的UI部分；
   - 本周完成了旧版本的新人挽留弹窗迁移到新的工程中；
   - 领京豆大改版总体进度20%；

## 2020-08-27

1. 领京豆大改版
   - 本周完成了迁移新人引导弹窗、新人连签三天提醒弹窗到新的工程中并对老的逻辑进行了优化；
   - 本周完成了沉浸式状态栏和导航栏的开发；
   - 本周完成了feeds流穿插通栏banner的样式和逻辑开发；
   - 本周解决了RN和H5惊喜福利楼层指示器的兼容问题，通过区分平台采用不同的实现方式完成横滑指示器的需求；
   - 本周领京豆大改版的整体进度达到了65%；

## 2020-09-03

领京豆大改版

- 本周解决了自测过程中发现的新页面中楼层的适配问题，并对下发数据进行了兜底处理，防止异常数据导致的崩溃；

  > 问题：
  >
  > 新页面开发时大部分时间采用的是IOS模拟器进行自测，本周在Android机器上自测发现新页面的部分楼层有部分字段显示不对齐或者有截断的现象；通过投放下发异常数据可能会导致前端崩溃的事件，本周重点自测了新页面部分字段不下发或者下发异常时的页面表现，发现了几处崩溃现象。
  >
  > 解决：
  >
  > 重点筛查了其他楼层在Android机器上的显示，解决了已发现的适配和兼容问题，并对下发异常数据进行兜底处理。

  

- 本周完成了浏览赚京豆楼层卡片任务的京豆奖励逻辑，由于浏览任务在不同的登录态、用户风控级别和任务的推进阶段的展示样式不同，控制逻辑较为复杂，本周重点将签到区域和浏览任务的逻辑进行了大量的自测，保证了逻辑的完善和代码的质量；

  > 问题：
  >
  > 浏览赚京豆楼层卡片任务和头部签到逻辑都是新页面的核心逻辑，由于浏览任务和日常签到在部分逻辑上耦合，浏览任务在不同的登录态、用户风控级别和任务的推进阶段的展示样式不同，控制逻辑较为复杂，且签到区域的用户粘性较高，稍有不慎可能会导致大量客诉。
  >
  > 解决：
  >
  > 为防止有遗漏的case导致核心逻辑出现纰漏，本周重点将签到区域和浏览任务的逻辑进行了大量的自测，保证了逻辑的完善和代码的质量；

  

- 本周视觉对部分缺失的UI切图进行了补充并调整了部分已有的UI细节，本周已完成了新增的UI样式；

  > 问题：
  >
  > 本周视觉发现有几处浏览赚京豆楼层卡片任务的状态不够完善，缺失了部分状态的UI切图，根据视觉最新提供的视觉标注，发现和之前相比氛围图的高度和部分布局有了变化。新增的部分视觉对已完成的部分样式有一定的影响。
  >
  > 解决：
  >
  > 经过前端和产品、运营的交涉，前端根据对已有排期的影响程度同意对缺失部分的UI进行补充开发，对于一些工时影响严重的新增需求，前端建议放到下个迭代进行排期，产品和运营同意。

  

- 本周领京豆大改版UI部分已经可以进行走查，部分逻辑问题和机型的兼容将在下周重点自测，总体进度达到了80%；

  > 大改版的UI部分已经全部画好，交互逻辑部分还在逐步完善当中。本周新页面可以进行UI部分的初步走查，尽早发现问题，尽早修改，尽早上线灰度，保证大促前有充分的时间进行灰度，保证页面的稳定性。

## 2020-09-10

领京豆大改版

- 本周进行了领京豆首页大改版的测试用例评审，由于后端的风控逻辑有所调整，前端需要根据用户的风控级别对用户的浏览任务进行区别处理，前端计划本周内完成此变更；
- 本周自测时发现在弱网条件下用户点击浏览卡片请求任务接口，待任务接口返回结果后再跳转有较大的时延，影响用户体验；经过和产品讨论改为用户从浏览页面返回领京豆首页时再去请求任务接口，新增了一些提示性的Toast弹窗，前端计划本周完成此变更；
- JDReact侧开发的RN切量配置已经研发完成，经过前端的测试发现IOS端的切量逻辑仅在站内采用扫码跳转有效，点击首页百宝箱位置的坑位不会跳转到配置的替换页面，经过排查发现JDReact 的ios研发未对jump协议进行openapp转换处理导致切量逻辑失效，JDReact侧研发正在修复此bug。
- 本周领京豆大改版的前端研发基本上已经完成，目前进入自测和联调阶段，计划下周二提测，目前总体进度90%。

## 2020-09-16

领京豆大改版

- 本周领京豆大改版RN和H5均已提测，目前跟测中；
- 业务走查反馈几处需要优化的UI样式和文案，前端计划本周内完成初步走查的相关改动；
- 本周讨论了双十一组团分京豆活动的实施方案，结论为活动页H5不再改动，新版和老版本的领京豆首页在主态采用切量命中的版本，客态采用老版本的H5领京豆首页，采用该方案前端工作量不大；
- 本周五进行了埋点评审；

## 2020-09-24

领京豆大改版

- 本周UI视觉走查反馈几处需要优化的UI样式，本周已完成最新走查问题的修改；
- 本周完成了领京豆大改版的埋点开发并提测；
- 本周修复了部分机型的兼容问题，目前持续跟测中；





